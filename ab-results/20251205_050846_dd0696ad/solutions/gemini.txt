Loaded cached credentials.
Here is a compact Bash function to calculate the weighted similarity.

```bash
calc_sim() {
    [ -f "$1" ] && [ -f "$2" ] || { echo 0; return; }
    # Helpers: U=Unique Lines, W=Unique Words, S=Unique Structure (Punctuation)
    U() { sort -u "$1"; }; W() { grep -oE '[a-zA-Z0-9_]+' "$1" | sort -u; }
    S() { tr -dc '[:punct:]\n' < "$1" | sed '/^$/d' | sort -u; }

    # Calculate Jaccard Indices (Intersection / Union) * 100
    LI=$(comm -12 <(U "$1") <(U "$2") | wc -l); LT=$(cat "$1" "$2" | sort -u | wc -l)
    KI=$(comm -12 <(W "$1") <(W "$2") | wc -l); KT=$(cat <(W "$1") <(W "$2") | sort -u | wc -l)
    SI=$(comm -12 <(S "$1") <(S "$2") | wc -l); ST=$(cat <(S "$1") <(S "$2") | sort -u | wc -l)

    SL=$((LT ? LI * 100 / LT : 0))
    SK=$((KT ? KI * 100 / KT : 0))
    SS=$((ST ? SI * 100 / ST : 0))

    # Weighted Average
    echo $(( (SL * $3 + SK * $4 + SS * $5) / ($3 + $4 + $5) ))
}
```

### Usage Example
```bash
# calc_sim file1.py file2.py 40 40 20
# Output: 75
```
